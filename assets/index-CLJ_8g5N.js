(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))C(w);new MutationObserver(w=>{for(const I of w)if(I.type==="childList")for(const F of I.addedNodes)F.tagName==="LINK"&&F.rel==="modulepreload"&&C(F)}).observe(document,{childList:!0,subtree:!0});function g(w){const I={};return w.integrity&&(I.integrity=w.integrity),w.referrerPolicy&&(I.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?I.credentials="include":w.crossOrigin==="anonymous"?I.credentials="omit":I.credentials="same-origin",I}function C(w){if(w.ep)return;w.ep=!0;const I=g(w);fetch(w.href,I)}})();var pe=63710088e-1,pn={centimeters:pe*100,centimetres:pe*100,degrees:pe/111325,feet:pe*3.28084,inches:pe*39.37,kilometers:pe/1e3,kilometres:pe/1e3,meters:pe,metres:pe,miles:pe/1609.344,millimeters:pe*1e3,millimetres:pe*1e3,nauticalmiles:pe/1852,radians:1,yards:pe*1.0936};function ft(h,s,g){g===void 0&&(g={});var C={type:"Feature"};return(g.id===0||g.id)&&(C.id=g.id),g.bbox&&(C.bbox=g.bbox),C.properties=s||{},C.geometry=h,C}function Co(h,s,g){if(g===void 0&&(g={}),!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ln(h[0])||!ln(h[1]))throw new Error("coordinates must contain numbers");var C={type:"Point",coordinates:h};return ft(C,s,g)}function To(h,s,g){g===void 0&&(g={});for(var C=0,w=h;C<w.length;C++){var I=w[C];if(I.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var F=0;F<I[I.length-1].length;F++)if(I[I.length-1][F]!==I[0][F])throw new Error("First and last Position are not equivalent.")}var P={type:"Polygon",coordinates:h};return ft(P,s,g)}function Mo(h,s,g){if(g===void 0&&(g={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");var C={type:"LineString",coordinates:h};return ft(C,s,g)}function So(h,s){s===void 0&&(s="kilometers");var g=pn[s];if(!g)throw new Error(s+" units is invalid");return h*g}function xo(h,s){s===void 0&&(s="kilometers");var g=pn[s];if(!g)throw new Error(s+" units is invalid");return h/g}function cn(h){var s=h%(2*Math.PI);return s*180/Math.PI}function qe(h){var s=h%360;return s*Math.PI/180}function ln(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}function pr(h){if(!h)throw new Error("coord is required");if(!Array.isArray(h)){if(h.type==="Feature"&&h.geometry!==null&&h.geometry.type==="Point")return h.geometry.coordinates;if(h.type==="Point")return h.coordinates}if(Array.isArray(h)&&h.length>=2&&!Array.isArray(h[0])&&!Array.isArray(h[1]))return h;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Oo(h,s,g,C){C===void 0&&(C={});var w=pr(h),I=qe(w[0]),F=qe(w[1]),P=qe(g),U=xo(s,C.units),a=Math.asin(Math.sin(F)*Math.cos(U)+Math.cos(F)*Math.sin(U)*Math.cos(P)),l=I+Math.atan2(Math.sin(P)*Math.sin(U)*Math.cos(F),Math.cos(U)-Math.sin(F)*Math.sin(a)),m=cn(l),b=cn(a);return Co([m,b],C.properties)}function wo(h,s,g){g===void 0&&(g={});for(var C=g.steps||64,w=g.properties?g.properties:!Array.isArray(h)&&h.type==="Feature"&&h.properties?h.properties:{},I=[],F=0;F<C;F++)I.push(Oo(h,s,F*-360/C,g).geometry.coordinates);return I.push(I[0]),To([I],w)}var rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hn(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var gn={exports:{}};(function(h,s){(function(g,C){h.exports=C()})(rt,function(){var g=function(e,t){var r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(i,u,v){if(r[i]===void 0)throw new Error("Invalid event type: "+i);r[i].push({selector:u,fn:v})},render:function(i){t.store.featureChanged(i)}},o=function(i,u){for(var v=r[i],E=v.length;E--;){var x=v[E];if(x.selector(u)){x.fn.call(n,u)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(i){o("drag",i)},click:function(i){o("click",i)},mousemove:function(i){o("mousemove",i)},mousedown:function(i){o("mousedown",i)},mouseup:function(i){o("mouseup",i)},mouseout:function(i){o("mouseout",i)},keydown:function(i){o("keydown",i)},keyup:function(i){o("keyup",i)},touchstart:function(i){o("touchstart",i)},touchmove:function(i){o("touchmove",i)},touchend:function(i){o("touchend",i)},tap:function(i){o("tap",i)}}};function C(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function w(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){if(this instanceof n){var o=[null];o.push.apply(o,arguments);var i=Function.bind.apply(t,o);return new i}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var I={},F={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},P=F;function U(e){var t=0;if(e&&e.length>0){t+=Math.abs(a(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(a(e[r]))}return t}function a(e){var t,r,n,o,i,u,v=0,E=e.length;if(E>2){for(u=0;u<E;u++)u===E-2?(n=E-2,o=E-1,i=0):u===E-1?(n=E-1,o=0,i=1):(n=u,o=u+1,i=u+2),t=e[n],r=e[o],v+=(l(e[i][0])-l(t[0]))*Math.sin(l(r[1]));v=v*P.RADIUS*P.RADIUS/2}return v}function l(e){return e*Math.PI/180}I.geometry=function e(t){var r,n=0;switch(t.type){case"Polygon":return U(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)n+=U(t.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<t.geometries.length;r++)n+=e(t.geometries[r]);return n}},I.ring=a;var m={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},b={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},d={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},_={POLYGON:"polygon",LINE:"line_string",POINT:"point"},p={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},M={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},k={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},V={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},D={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},G={ACTIVE:"true",INACTIVE:"false"},Y=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Ee=-85,ae=Object.freeze({__proto__:null,classes:m,sources:b,cursors:d,types:_,geojsonTypes:p,modes:M,events:k,updateActions:V,meta:D,activeStates:G,interactions:Y,LAT_MIN:-90,LAT_RENDERED_MIN:Ee,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),me={Point:0,LineString:1,MultiLineString:1,Polygon:2};function te(e,t){var r=me[e.geometry.type]-me[t.geometry.type];return r===0&&e.geometry.type===p.POLYGON?e.area-t.area:r}function de(e){return e.map(function(t){return t.geometry.type===p.POLYGON&&(t.area=I.geometry({type:p.FEATURE,property:{},geometry:t.geometry})),t}).sort(te).map(function(t){return delete t.area,t})}function Ze(e,t){return t===void 0&&(t=0),[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function se(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(var t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}se.prototype.add=function(e){return this.has(e)||(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length),this},se.prototype.delete=function(e){return this.has(e)===!1||(this._length--,delete this._items[e],delete this._nums[e]),this},se.prototype.has=function(e){return(typeof e=="string"||typeof e=="number")&&(this._items[e]!==void 0||this._nums[e]!==void 0)},se.prototype.values=function(){var e=this,t=[];return Object.keys(this._items).forEach(function(r){t.push({k:r,v:e._items[r]})}),Object.keys(this._nums).forEach(function(r){t.push({k:JSON.parse(r),v:e._nums[r]})}),t.sort(function(r,n){return r.v-n.v}).map(function(r){return r.k})},se.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ve=[D.FEATURE,D.MIDPOINT,D.VERTEX],Se={click:function(e,t,r){return hr(e,t,r,r.options.clickBuffer)},touch:function(e,t,r){return hr(e,t,r,r.options.touchBuffer)}};function hr(e,t,r,n){if(r.map===null)return[];var o=e?Ze(e,n):t,i={};r.options.styles&&(i.layers=r.options.styles.map(function(x){return x.id}).filter(function(x){return r.map.getLayer(x)!=null}));var u=r.map.queryRenderedFeatures(o,i).filter(function(x){return ve.indexOf(x.properties.meta)!==-1}),v=new se,E=[];return u.forEach(function(x){var O=x.properties.id;v.has(O)||(v.add(O),E.push(x))}),de(E)}function ht(e,t){var r=Se.click(e,null,t),n={mouse:d.NONE};return r[0]&&(n.mouse=r[0].properties.active===G.ACTIVE?d.MOVE:d.POINTER,n.feature=r[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(n.mouse=d.ADD),t.ui.queueMapClasses(n),t.ui.updateMapClasses(),r[0]}function zt(e,t){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function Jt(e,t,r){r===void 0&&(r={});var n=r.fineTolerance!=null?r.fineTolerance:4,o=r.grossTolerance!=null?r.grossTolerance:12,i=r.interval!=null?r.interval:500;e.point=e.point||t.point,e.time=e.time||t.time;var u=zt(e.point,t.point);return u<n||u<o&&t.time-e.time<i}function Yt(e,t,r){r===void 0&&(r={});var n=r.tolerance!=null?r.tolerance:25,o=r.interval!=null?r.interval:250;return e.point=e.point||t.point,e.time=e.time||t.time,zt(e.point,t.point)<n&&t.time-e.time<o}var gr={exports:{}},qt=gr.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,e/n))/Math.log(t)*n;var o=r-Math.floor(r),i="";for(n=0;n<Math.floor(r);n++)i=Math.floor(Math.random()*t).toString(t)+i;if(o){var u=Math.pow(t,o);i=Math.floor(Math.random()*u).toString(t)+i}var v=parseInt(i,t);return v!==1/0&&v>=Math.pow(2,e)?qt(e,t):i};qt.rack=function(e,t,r){var n=function(i){var u=0;do{if(u++>10){if(!r)throw new Error("too many ID collisions, use more bits");e+=r}var v=qt(e,t)}while(Object.hasOwnProperty.call(o,v));return o[v]=i,v},o=n.hats={};return n.get=function(i){return n.hats[i]},n.set=function(i,u){return n.hats[i]=u,n},n.bits=e||128,n.base=t||16,n};var Zt=C(gr.exports),ue=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||Zt(),this.type=t.geometry.type};ue.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},ue.prototype.incomingCoords=function(e){this.setCoordinates(e)},ue.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},ue.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},ue.prototype.setProperty=function(e,t){this.properties[e]=t},ue.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:p.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},ue.prototype.internal=function(e){var t={id:this.id,meta:D.FEATURE,"meta:type":this.type,active:G.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(var r in this.properties)t["user_"+r]=this.properties[r];return{type:p.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var Ue=function(e,t){ue.call(this,e,t)};(Ue.prototype=Object.create(ue.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},Ue.prototype.updateCoordinate=function(e,t,r){this.coordinates=arguments.length===3?[t,r]:[e,t],this.changed()},Ue.prototype.getCoordinate=function(){return this.getCoordinates()};var xe=function(e,t){ue.call(this,e,t)};(xe.prototype=Object.create(ue.prototype)).isValid=function(){return this.coordinates.length>1},xe.prototype.addCoordinate=function(e,t,r){this.changed();var n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])},xe.prototype.getCoordinate=function(e){var t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))},xe.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)},xe.prototype.updateCoordinate=function(e,t,r){var n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};var he=function(e,t){ue.call(this,e,t),this.coordinates=this.coordinates.map(function(r){return r.slice(0,-1)})};(he.prototype=Object.create(ue.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(e){return e.length>2})},he.prototype.incomingCoords=function(e){this.coordinates=e.map(function(t){return t.slice(0,-1)}),this.changed()},he.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()},he.prototype.addCoordinate=function(e,t,r){this.changed();var n=e.split(".").map(function(o){return parseInt(o,10)});this.coordinates[n[0]].splice(n[1],0,[t,r])},he.prototype.removeCoordinate=function(e){this.changed();var t=e.split(".").map(function(n){return parseInt(n,10)}),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))},he.prototype.getCoordinate=function(e){var t=e.split(".").map(function(n){return parseInt(n,10)}),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))},he.prototype.getCoordinates=function(){return this.coordinates.map(function(e){return e.concat([e[0]])})},he.prototype.updateCoordinate=function(e,t,r){this.changed();var n=e.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);this.coordinates[o]===void 0&&(this.coordinates[o]=[]),this.coordinates[o][i]=[t,r]};var _n={MultiPoint:Ue,MultiLineString:xe,MultiPolygon:he},gt=function(e,t,r,n,o){var i=r.split("."),u=parseInt(i[0],10),v=i[1]?i.slice(1).join("."):null;return e[u][t](v,n,o)},fe=function(e,t){if(ue.call(this,e,t),delete this.coordinates,this.model=_n[t.geometry.type],this.model===void 0)throw new TypeError(t.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(t.geometry.coordinates)};function B(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}(fe.prototype=Object.create(ue.prototype))._coordinatesToFeatures=function(e){var t=this,r=this.model.bind(this);return e.map(function(n){return new r(t.ctx,{id:Zt(),type:p.FEATURE,properties:{},geometry:{coordinates:n,type:t.type.replace("Multi","")}})})},fe.prototype.isValid=function(){return this.features.every(function(e){return e.isValid()})},fe.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()},fe.prototype.getCoordinate=function(e){return gt(this.features,"getCoordinate",e)},fe.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(e){return e.type===p.POLYGON?e.getCoordinates():e.coordinates})))},fe.prototype.updateCoordinate=function(e,t,r){gt(this.features,"updateCoordinate",e,t,r),this.changed()},fe.prototype.addCoordinate=function(e,t,r){gt(this.features,"addCoordinate",e,t,r),this.changed()},fe.prototype.removeCoordinate=function(e){gt(this.features,"removeCoordinate",e),this.changed()},fe.prototype.getFeatures=function(){return this.features},B.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)},B.prototype.setSelectedCoordinates=function(e){var t=this;this._ctx.store.setSelectedCoordinates(e),e.reduce(function(r,n){return r[n.feature_id]===void 0&&(r[n.feature_id]=!0,t._ctx.store.get(n.feature_id).changed()),r},{})},B.prototype.getSelected=function(){return this._ctx.store.getSelected()},B.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},B.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)},B.prototype.getFeature=function(e){return this._ctx.store.get(e)},B.prototype.select=function(e){return this._ctx.store.select(e)},B.prototype.deselect=function(e){return this._ctx.store.deselect(e)},B.prototype.deleteFeature=function(e,t){return t===void 0&&(t={}),this._ctx.store.delete(e,t)},B.prototype.addFeature=function(e){return this._ctx.store.add(e)},B.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},B.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},B.prototype.setActionableState=function(e){e===void 0&&(e={});var t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)},B.prototype.changeMode=function(e,t,r){return t===void 0&&(t={}),r===void 0&&(r={}),this._ctx.events.changeMode(e,t,r)},B.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)},B.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)},B.prototype.featuresAt=function(e,t,r){if(r===void 0&&(r="click"),r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return Se[r](e,t,this._ctx)},B.prototype.newFeature=function(e){var t=e.geometry.type;return t===p.POINT?new Ue(this._ctx,e):t===p.LINE_STRING?new xe(this._ctx,e):t===p.POLYGON?new he(this._ctx,e):new fe(this._ctx,e)},B.prototype.isInstanceOf=function(e,t){if(e===p.POINT)return t instanceof Ue;if(e===p.LINE_STRING)return t instanceof xe;if(e===p.POLYGON)return t instanceof he;if(e==="MultiFeature")return t instanceof fe;throw new Error("Unknown feature class: "+e)},B.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)},B.prototype.onSetup=function(){},B.prototype.onDrag=function(){},B.prototype.onClick=function(){},B.prototype.onMouseMove=function(){},B.prototype.onMouseDown=function(){},B.prototype.onMouseUp=function(){},B.prototype.onMouseOut=function(){},B.prototype.onKeyUp=function(){},B.prototype.onKeyDown=function(){},B.prototype.onTouchStart=function(){},B.prototype.onTouchMove=function(){},B.prototype.onTouchEnd=function(){},B.prototype.onTap=function(){},B.prototype.onStop=function(){},B.prototype.onTrash=function(){},B.prototype.onCombineFeature=function(){},B.prototype.onUncombineFeature=function(){},B.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var yr={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},En=Object.keys(yr);function Cn(e){var t=Object.keys(e);return function(r,n){n===void 0&&(n={});var o={},i=t.reduce(function(u,v){return u[v]=e[v],u},new B(r));return{start:function(){var u=this;o=i.onSetup(n),En.forEach(function(v){var E,x=yr[v],O=function(){return!1};e[x]&&(O=function(){return!0}),u.on(v,O,(E=x,function(T){return i[E](o,T)}))})},stop:function(){i.onStop(o)},trash:function(){i.onTrash(o)},combineFeatures:function(){i.onCombineFeatures(o)},uncombineFeatures:function(){i.onUncombineFeatures(o)},render:function(u,v){i.toDisplayFeatures(o,u,v)}}}}function nt(e){return[].concat(e).filter(function(t){return t!==void 0})}function Tn(){var e=this;if(!(e.ctx.map&&e.ctx.map.getSource(b.HOT)!==void 0))return E();var t=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:t});var r=[],n=[];e.isDirty?n=e.getAllIds():(r=e.getChangedIds().filter(function(x){return e.get(x)!==void 0}),n=e.sources.hot.filter(function(x){return x.properties.id&&r.indexOf(x.properties.id)===-1&&e.get(x.properties.id)!==void 0}).map(function(x){return x.properties.id})),e.sources.hot=[];var o=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(function(x){var O=x.properties.id||x.properties.parent;return r.indexOf(O)===-1});var i=o!==e.sources.cold.length||n.length>0;function u(x,O){var T=e.get(x).internal(t);e.ctx.events.currentModeRender(T,function(A){e.sources[O].push(A)})}if(r.forEach(function(x){return u(x,"hot")}),n.forEach(function(x){return u(x,"cold")}),i&&e.ctx.map.getSource(b.COLD).setData({type:p.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(b.HOT).setData({type:p.FEATURE_COLLECTION,features:e.sources.hot}),e._emitSelectionChange&&(e.ctx.map.fire(k.SELECTION_CHANGE,{features:e.getSelected().map(function(x){return x.toGeoJSON()}),points:e.getSelectedCoordinates().map(function(x){return{type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:x.coordinates}}})}),e._emitSelectionChange=!1),e._deletedFeaturesToEmit.length){var v=e._deletedFeaturesToEmit.map(function(x){return x.toGeoJSON()});e._deletedFeaturesToEmit=[],e.ctx.map.fire(k.DELETE,{features:v})}function E(){e.isDirty=!1,e.clearChangedIds()}E(),e.ctx.map.fire(k.RENDER,{})}function q(e){var t,r=this;this._features={},this._featureIds=new se,this._selectedFeatureIds=new se,this._selectedCoordinates=[],this._changedFeatureIds=new se,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=function(){t||(t=requestAnimationFrame(function(){t=null,Tn.call(r)}))},this.isDirty=!1}function mr(e,t){var r=e._selectedCoordinates.filter(function(n){return e._selectedFeatureIds.has(n.feature_id)});e._selectedCoordinates.length===r.length||t.silent||(e._emitSelectionChange=!0),e._selectedCoordinates=r}q.prototype.createRenderBatch=function(){var e=this,t=this.render,r=0;return this.render=function(){r++},function(){e.render=t,r>0&&e.render()}},q.prototype.setDirty=function(){return this.isDirty=!0,this},q.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this},q.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},q.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},q.prototype.getAllIds=function(){return this._featureIds.values()},q.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this},q.prototype.delete=function(e,t){var r=this;return t===void 0&&(t={}),nt(e).forEach(function(n){r._featureIds.has(n)&&(r._featureIds.delete(n),r._selectedFeatureIds.delete(n),t.silent||r._deletedFeaturesToEmit.indexOf(r._features[n])===-1&&r._deletedFeaturesToEmit.push(r._features[n]),delete r._features[n],r.isDirty=!0)}),mr(this,t),this},q.prototype.get=function(e){return this._features[e]},q.prototype.getAll=function(){var e=this;return Object.keys(this._features).map(function(t){return e._features[t]})},q.prototype.select=function(e,t){var r=this;return t===void 0&&(t={}),nt(e).forEach(function(n){r._selectedFeatureIds.has(n)||(r._selectedFeatureIds.add(n),r._changedFeatureIds.add(n),t.silent||(r._emitSelectionChange=!0))}),this},q.prototype.deselect=function(e,t){var r=this;return t===void 0&&(t={}),nt(e).forEach(function(n){r._selectedFeatureIds.has(n)&&(r._selectedFeatureIds.delete(n),r._changedFeatureIds.add(n),t.silent||(r._emitSelectionChange=!0))}),mr(this,t),this},q.prototype.clearSelected=function(e){return e===void 0&&(e={}),this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this},q.prototype.setSelected=function(e,t){var r=this;return t===void 0&&(t={}),e=nt(e),this.deselect(this._selectedFeatureIds.values().filter(function(n){return e.indexOf(n)===-1}),{silent:t.silent}),this.select(e.filter(function(n){return!r._selectedFeatureIds.has(n)}),{silent:t.silent}),this},q.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this},q.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},q.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},q.prototype.getSelected=function(){var e=this;return this._selectedFeatureIds.values().map(function(t){return e.get(t)})},q.prototype.getSelectedCoordinates=function(){var e=this;return this._selectedCoordinates.map(function(t){return{coordinates:e.get(t.feature_id).getCoordinate(t.coord_path)}})},q.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)},q.prototype.setFeatureProperty=function(e,t,r){this.get(e).setProperty(t,r),this.featureChanged(e)},q.prototype.storeMapConfig=function(){var e=this;Y.forEach(function(t){e.ctx.map[t]&&(e._mapInitialConfig[t]=e.ctx.map[t].isEnabled())})},q.prototype.restoreMapConfig=function(){var e=this;Object.keys(this._mapInitialConfig).forEach(function(t){e._mapInitialConfig[t]?e.ctx.map[t].enable():e.ctx.map[t].disable()})},q.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]===void 0||this._mapInitialConfig[e]};var Mn=function(){for(var e=arguments,t={},r=0;r<arguments.length;r++){var n=e[r];for(var o in n)Sn.call(n,o)&&(t[o]=n[o])}return t},Sn=Object.prototype.hasOwnProperty,Ne=C(Mn),xn=["mode","feature","mouse"];function On(e){var t=null,r=null,n={onRemove:function(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){var i=o.fire;return o.fire=function(u,v){var E=arguments;return i.length===1&&arguments.length!==1&&(E=[Ne({},{type:u},v)]),i.apply(o,E)},e.map=o,e.events=function(u){var v=Object.keys(u.options.modes).reduce(function(y,L){return y[L]=Cn(u.options.modes[L]),y},{}),E={},x={},O={},T=null,A=null;O.drag=function(y,L){L({point:y.point,time:new Date().getTime()})?(u.ui.queueMapClasses({mouse:d.DRAG}),A.drag(y)):y.originalEvent.stopPropagation()},O.mousedrag=function(y){O.drag(y,function(L){return!Jt(E,L)})},O.touchdrag=function(y){O.drag(y,function(L){return!Yt(x,L)})},O.mousemove=function(y){if((y.originalEvent.buttons!==void 0?y.originalEvent.buttons:y.originalEvent.which)===1)return O.mousedrag(y);var L=ht(y,u);y.featureTarget=L,A.mousemove(y)},O.mousedown=function(y){E={time:new Date().getTime(),point:y.point};var L=ht(y,u);y.featureTarget=L,A.mousedown(y)},O.mouseup=function(y){var L=ht(y,u);y.featureTarget=L,Jt(E,{point:y.point,time:new Date().getTime()})?A.click(y):A.mouseup(y)},O.mouseout=function(y){A.mouseout(y)},O.touchstart=function(y){if(u.options.touchEnabled){x={time:new Date().getTime(),point:y.point};var L=Se.touch(y,null,u)[0];y.featureTarget=L,A.touchstart(y)}},O.touchmove=function(y){if(u.options.touchEnabled)return A.touchmove(y),O.touchdrag(y)},O.touchend=function(y){if(y.originalEvent.preventDefault(),u.options.touchEnabled){var L=Se.touch(y,null,u)[0];y.featureTarget=L,Yt(x,{time:new Date().getTime(),point:y.point})?A.tap(y):A.touchend(y)}};var W=function(y){return!(y===8||y===46||y>=48&&y<=57)};function R(y,L,$){$===void 0&&($={}),A.stop();var ie=v[y];if(ie===void 0)throw new Error(y+" is not valid");T=y;var Q=ie(u,L);A=g(Q,u),$.silent||u.map.fire(k.MODE_CHANGE,{mode:y}),u.store.setDirty(),u.store.render()}O.keydown=function(y){(y.srcElement||y.target).classList.contains("mapboxgl-canvas")&&(y.keyCode!==8&&y.keyCode!==46||!u.options.controls.trash?W(y.keyCode)?A.keydown(y):y.keyCode===49&&u.options.controls.point?R(M.DRAW_POINT):y.keyCode===50&&u.options.controls.line_string?R(M.DRAW_LINE_STRING):y.keyCode===51&&u.options.controls.polygon&&R(M.DRAW_POLYGON):(y.preventDefault(),A.trash()))},O.keyup=function(y){W(y.keyCode)&&A.keyup(y)},O.zoomend=function(){u.store.changeZoom()},O.data=function(y){if(y.dataType==="style"){var L=u.setup,$=u.map,ie=u.options,Q=u.store;ie.styles.some(function(rr){return $.getLayer(rr.id)})||(L.addLayers(),Q.setDirty(),Q.render())}};var K={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){T=u.options.defaultMode,A=g(v[T](u),u)},changeMode:R,actionable:function(y){var L=!1;Object.keys(y).forEach(function($){if(K[$]===void 0)throw new Error("Invalid action type");K[$]!==y[$]&&(L=!0),K[$]=y[$]}),L&&u.map.fire(k.ACTIONABLE,{actions:K})},currentModeName:function(){return T},currentModeRender:function(y,L){return A.render(y,L)},fire:function(y,L){O[y]&&O[y](L)},addEventListeners:function(){u.map.on("mousemove",O.mousemove),u.map.on("mousedown",O.mousedown),u.map.on("mouseup",O.mouseup),u.map.on("data",O.data),u.map.on("touchmove",O.touchmove),u.map.on("touchstart",O.touchstart),u.map.on("touchend",O.touchend),u.container.addEventListener("mouseout",O.mouseout),u.options.keybindings&&(u.container.addEventListener("keydown",O.keydown),u.container.addEventListener("keyup",O.keyup))},removeEventListeners:function(){u.map.off("mousemove",O.mousemove),u.map.off("mousedown",O.mousedown),u.map.off("mouseup",O.mouseup),u.map.off("data",O.data),u.map.off("touchmove",O.touchmove),u.map.off("touchstart",O.touchstart),u.map.off("touchend",O.touchend),u.container.removeEventListener("mouseout",O.mouseout),u.options.keybindings&&(u.container.removeEventListener("keydown",O.keydown),u.container.removeEventListener("keyup",O.keyup))},trash:function(y){A.trash(y)},combineFeatures:function(){A.combineFeatures()},uncombineFeatures:function(){A.uncombineFeatures()},getMode:function(){return T}}}(e),e.ui=function(u){var v={},E=null,x={mode:null,feature:null,mouse:null},O={mode:null,feature:null,mouse:null};function T(y){O=Ne(O,y)}function A(){var y,L;if(u.container){var $=[],ie=[];xn.forEach(function(Q){O[Q]!==x[Q]&&($.push(Q+"-"+x[Q]),O[Q]!==null&&ie.push(Q+"-"+O[Q]))}),$.length>0&&(y=u.container.classList).remove.apply(y,$),ie.length>0&&(L=u.container.classList).add.apply(L,ie),x=Ne(x,O)}}function W(y,L){L===void 0&&(L={});var $=document.createElement("button");return $.className=m.CONTROL_BUTTON+" "+L.className,$.setAttribute("title",L.title),L.container.appendChild($),$.addEventListener("click",function(ie){if(ie.preventDefault(),ie.stopPropagation(),ie.target===E)return R(),void L.onDeactivate();K(y),L.onActivate()},!0),$}function R(){E&&(E.classList.remove(m.ACTIVE_BUTTON),E=null)}function K(y){R();var L=v[y];L&&L&&y!=="trash"&&(L.classList.add(m.ACTIVE_BUTTON),E=L)}return{setActiveButton:K,queueMapClasses:T,updateMapClasses:A,clearMapClasses:function(){T({mode:null,feature:null,mouse:null}),A()},addButtons:function(){var y=u.options.controls,L=document.createElement("div");return L.className=m.CONTROL_GROUP+" "+m.CONTROL_BASE,y&&(y[_.LINE]&&(v[_.LINE]=W(_.LINE,{container:L,className:m.CONTROL_BUTTON_LINE,title:"LineString tool "+(u.options.keybindings?"(l)":""),onActivate:function(){return u.events.changeMode(M.DRAW_LINE_STRING)},onDeactivate:function(){return u.events.trash()}})),y[_.POLYGON]&&(v[_.POLYGON]=W(_.POLYGON,{container:L,className:m.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(u.options.keybindings?"(p)":""),onActivate:function(){return u.events.changeMode(M.DRAW_POLYGON)},onDeactivate:function(){return u.events.trash()}})),y[_.POINT]&&(v[_.POINT]=W(_.POINT,{container:L,className:m.CONTROL_BUTTON_POINT,title:"Marker tool "+(u.options.keybindings?"(m)":""),onActivate:function(){return u.events.changeMode(M.DRAW_POINT)},onDeactivate:function(){return u.events.trash()}})),y.trash&&(v.trash=W("trash",{container:L,className:m.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){u.events.trash()}})),y.combine_features&&(v.combine_features=W("combineFeatures",{container:L,className:m.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){u.events.combineFeatures()}})),y.uncombine_features&&(v.uncombine_features=W("uncombineFeatures",{container:L,className:m.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){u.events.uncombineFeatures()}}))),L},removeButtons:function(){Object.keys(v).forEach(function(y){var L=v[y];L.parentNode&&L.parentNode.removeChild(L),delete v[y]})}}}(e),e.container=o.getContainer(),e.store=new q(e),t=e.ui.addButtons(),e.options.boxSelect&&(e.boxZoomInitial=o.boxZoom.isEnabled(),o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?n.connect():(o.on("load",n.connect),r=setInterval(function(){o.loaded()&&n.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(b.COLD,{data:{type:p.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(b.HOT,{data:{type:p.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(function(o){e.map.addLayer(o)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(function(o){e.map.getLayer(o.id)&&e.map.removeLayer(o.id)}),e.map.getSource(b.COLD)&&e.map.removeSource(b.COLD),e.map.getSource(b.HOT)&&e.map.removeSource(b.HOT)}};return e.setup=n,n}var vr=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function yt(e){return function(t){var r=t.featureTarget;return!!r&&!!r.properties&&r.properties.meta===e}}function br(e){return!!e.originalEvent&&!!e.originalEvent.shiftKey&&e.originalEvent.button===0}function Be(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===G.ACTIVE&&e.featureTarget.properties.meta===D.FEATURE}function Ht(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.active===G.INACTIVE&&e.featureTarget.properties.meta===D.FEATURE}function mt(e){return e.featureTarget===void 0}function Wt(e){return!!e.featureTarget&&!!e.featureTarget.properties&&e.featureTarget.properties.meta===D.FEATURE}function ot(e){var t=e.featureTarget;return!!t&&!!t.properties&&t.properties.meta===D.VERTEX}function vt(e){return!!e.originalEvent&&e.originalEvent.shiftKey===!0}function bt(e){return e.keyCode===27}function _t(e){return e.keyCode===13}var wn=Object.freeze({__proto__:null,isOfMetaType:yt,isShiftMousedown:br,isActiveFeature:Be,isInactiveFeature:Ht,noTarget:mt,isFeature:Wt,isVertex:ot,isShiftDown:vt,isEscapeKey:bt,isEnterKey:_t,isTrue:function(){return!0}}),In=He;function He(e,t){this.x=e,this.y=t}He.prototype={clone:function(){return new He(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,o=r*this.x+t*this.y;return this.x=n,this.y=o,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),o=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=o,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},He.convert=function(e){return e instanceof He?e:Array.isArray(e)?new He(e[0],e[1]):e};var Ln=C(In);function Xt(e,t){var r=t.getBoundingClientRect();return new Ln(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}function We(e,t,r,n){return{type:p.FEATURE,properties:{meta:D.VERTEX,parent:e,coord_path:r,active:n?G.ACTIVE:G.INACTIVE},geometry:{type:p.POINT,coordinates:t}}}function _r(e,t,r){var n=t.geometry.coordinates,o=r.geometry.coordinates;if(n[1]>85||n[1]<Ee||o[1]>85||o[1]<Ee)return null;var i={lng:(n[0]+o[0])/2,lat:(n[1]+o[1])/2};return{type:p.FEATURE,properties:{meta:D.MIDPOINT,parent:e,lng:i.lng,lat:i.lat,coord_path:r.properties.coord_path},geometry:{type:p.POINT,coordinates:[i.lng,i.lat]}}}function Et(e,t,r){t===void 0&&(t={}),r===void 0&&(r=null);var n,o=e.geometry,i=o.type,u=o.coordinates,v=e.properties&&e.properties.id,E=[];function x(T,A){var W="",R=null;T.forEach(function(K,y){var L=A!=null?A+"."+y:String(y),$=We(v,K,L,O(L));if(t.midpoints&&R){var ie=_r(v,R,$);ie&&E.push(ie)}R=$;var Q=JSON.stringify(K);W!==Q&&E.push($),y===0&&(W=Q)})}function O(T){return!!t.selectedPaths&&t.selectedPaths.indexOf(T)!==-1}return i===p.POINT?E.push(We(v,u,r,O(r))):i===p.POLYGON?u.forEach(function(T,A){x(T,r!==null?r+"."+A:String(A))}):i===p.LINE_STRING?x(u,r):i.indexOf(p.MULTI_PREFIX)===0&&(n=i.replace(p.MULTI_PREFIX,""),u.forEach(function(T,A){var W={type:p.FEATURE,properties:e.properties,geometry:{type:n,coordinates:T}};E=E.concat(Et(W,t,A))})),E}var be={enable:function(e){setTimeout(function(){e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable:function(e){setTimeout(function(){e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()},0)}},Ct={exports:{}},Er=function(e){if(!e||!e.type)return null;var t=Pn[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e},Pn={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},Nn=C(Er),Fn=Object.freeze({__proto__:null,default:function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(r,n){return r.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:r};return t.id!==void 0&&(n.id=t.id),n}):[t];case"MultiPoint":return t.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return t.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return t.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return t.geometries.map(e).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}}}),An=Er,Tt=w(Fn),Rn=function(e){return function t(r){return Array.isArray(r)&&r.length&&typeof r[0]=="number"?[r]:r.reduce(function(n,o){return Array.isArray(o)&&Array.isArray(o[0])?n.concat(t(o)):(n.push(o),n)},[])}(e)};Tt instanceof Function||(Tt=Tt.default);var Cr={exports:{}},kn=Cr.exports=function(e){return new ge(e)};function ge(e){this.value=e}function Tr(e,t,r){var n=[],o=[],i=!0;return function u(v){var E=r?Mr(v):v,x={},O=!0,T={node:E,node_:v,path:[].concat(n),parent:o[o.length-1],parents:o,key:n.slice(-1)[0],isRoot:n.length===0,level:n.length,circular:null,update:function(R,K){T.isRoot||(T.parent.node[T.key]=R),T.node=R,K&&(O=!1)},delete:function(R){delete T.parent.node[T.key],R&&(O=!1)},remove:function(R){Sr(T.parent.node)?T.parent.node.splice(T.key,1):delete T.parent.node[T.key],R&&(O=!1)},keys:null,before:function(R){x.before=R},after:function(R){x.after=R},pre:function(R){x.pre=R},post:function(R){x.post=R},stop:function(){i=!1},block:function(){O=!1}};if(!i)return T;function A(){if(typeof T.node=="object"&&T.node!==null){T.keys&&T.node_===T.node||(T.keys=Mt(T.node)),T.isLeaf=T.keys.length==0;for(var R=0;R<o.length;R++)if(o[R].node_===v){T.circular=o[R];break}}else T.isLeaf=!0,T.keys=null;T.notLeaf=!T.isLeaf,T.notRoot=!T.isRoot}A();var W=t.call(T,T.node);return W!==void 0&&T.update&&T.update(W),x.before&&x.before.call(T,T.node),O&&(typeof T.node!="object"||T.node===null||T.circular||(o.push(T),A(),St(T.keys,function(R,K){n.push(R),x.pre&&x.pre.call(T,T.node[R],R);var y=u(T.node[R]);r&&xt.call(T.node,R)&&(T.node[R]=y.node),y.isLast=K==T.keys.length-1,y.isFirst=K==0,x.post&&x.post.call(T,y),n.pop()}),o.pop()),x.after&&x.after.call(T,T.node)),T}(e).node}function Mr(e){if(typeof e=="object"&&e!==null){var t;if(Sr(e))t=[];else if(Xe(e)==="[object Date]")t=new Date(e.getTime?e.getTime():e);else if(function(o){return Xe(o)==="[object RegExp]"}(e))t=new RegExp(e);else if(function(o){return Xe(o)==="[object Error]"}(e))t={message:e.message};else if(function(o){return Xe(o)==="[object Boolean]"}(e))t=new Boolean(e);else if(function(o){return Xe(o)==="[object Number]"}(e))t=new Number(e);else if(function(o){return Xe(o)==="[object String]"}(e))t=new String(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var r=e.constructor&&e.constructor.prototype||e.__proto__||{},n=function(){};n.prototype=r,t=new n}return St(Mt(e),function(o){t[o]=e[o]}),t}return e}ge.prototype.get=function(e){for(var t=this.value,r=0;r<e.length;r++){var n=e[r];if(!t||!xt.call(t,n)){t=void 0;break}t=t[n]}return t},ge.prototype.has=function(e){for(var t=this.value,r=0;r<e.length;r++){var n=e[r];if(!t||!xt.call(t,n))return!1;t=t[n]}return!0},ge.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var o=e[n];xt.call(r,o)||(r[o]={}),r=r[o]}return r[e[n]]=t,t},ge.prototype.map=function(e){return Tr(this.value,e,!0)},ge.prototype.forEach=function(e){return this.value=Tr(this.value,e,!1),this.value},ge.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(o){this.isRoot&&r||(n=e.call(this,n,o))}),n},ge.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},ge.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},ge.prototype.clone=function(){var e=[],t=[];return function r(n){for(var o=0;o<e.length;o++)if(e[o]===n)return t[o];if(typeof n=="object"&&n!==null){var i=Mr(n);return e.push(n),t.push(i),St(Mt(n),function(u){i[u]=r(n[u])}),e.pop(),t.pop(),i}return n}(this.value)};var Mt=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};function Xe(e){return Object.prototype.toString.call(e)}var Sr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},St=function(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)};St(Mt(ge.prototype),function(e){kn[e]=function(t){var r=[].slice.call(arguments,1),n=new ge(t);return n[e].apply(n,r)}});var xt=Object.hasOwnProperty||function(e,t){return t in e},Dn=Cr.exports,Un=ce;function ce(e){if(!(this instanceof ce))return new ce(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}ce.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this},ce.prototype.equals=function(e){var t;return t=e instanceof ce?e.bbox():e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]},ce.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},ce.prototype.union=function(e){var t;return this._valid=!0,t=e instanceof ce?e.bbox():e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this},ce.prototype.bbox=function(){return this._valid?this._bbox:null},ce.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r},ce.prototype.intersect=function(e){return this._valid?(t=e instanceof ce?e.bbox():e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])):null;var t},ce.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)},ce.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var Bn=function(e){if(!e)return[];var t=Tt(An(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(Rn(n.geometry.coordinates)))}),r},jn=Dn,Vn=Un,xr={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},Gn=Object.keys(xr);function Kt(e){for(var t=Vn(),r=Bn(e),n=0;n<r.length;n++)t.include(r[n]);return t}Ct.exports=function(e){return Kt(e).bbox()},Ct.exports.polygon=function(e){return Kt(e).polygon()},Ct.exports.bboxify=function(e){return jn(e).map(function(t){t&&Gn.some(function(r){return!!t[r]&&xr[r].indexOf(t.type)!==-1})&&(t.bbox=Kt(t).bbox(),this.update(t))})};var $n=C(Ct.exports),Ot=-90;function Qt(e,t){var r=Ot,n=90,o=Ot,i=90,u=270,v=-270;e.forEach(function(x){var O=$n(x),T=O[1],A=O[3],W=O[0],R=O[2];T>r&&(r=T),A<n&&(n=A),A>o&&(o=A),T<i&&(i=T),W<u&&(u=W),R>v&&(v=R)});var E=t;return r+E.lat>85&&(E.lat=85-r),o+E.lat>90&&(E.lat=90-o),n+E.lat<-85&&(E.lat=-85-n),i+E.lat<Ot&&(E.lat=Ot-i),u+E.lng<=-270&&(E.lng+=360*Math.ceil(Math.abs(E.lng)/360)),v+E.lng>=270&&(E.lng-=360*Math.ceil(Math.abs(E.lng)/360)),E}function er(e,t){var r=Qt(e.map(function(n){return n.toGeoJSON()}),t);e.forEach(function(n){var o,i=n.getCoordinates(),u=function(E){var x={lng:E[0]+r.lng,lat:E[1]+r.lat};return[x.lng,x.lat]},v=function(E){return E.map(function(x){return u(x)})};n.type===p.POINT?o=u(i):n.type===p.LINE_STRING||n.type===p.MULTI_POINT?o=i.map(u):n.type===p.POLYGON||n.type===p.MULTI_LINE_STRING?o=i.map(v):n.type===p.MULTI_POLYGON&&(o=i.map(function(E){return E.map(function(x){return v(x)})})),n.incomingCoords(o)})}var re={onSetup:function(e){var t=this,r={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(r.initiallySelectedFeatureIds.filter(function(n){return t.getFeature(n)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),r},fireUpdate:function(){this.map.fire(k.UPDATE,{action:V.MOVE,features:this.getSelected().map(function(e){return e.toGeoJSON()})})},fireActionable:function(){var e=this,t=this.getSelected(),r=t.filter(function(v){return e.isInstanceOf("MultiFeature",v)}),n=!1;if(t.length>1){n=!0;var o=t[0].type.replace("Multi","");t.forEach(function(v){v.type.replace("Multi","")!==o&&(n=!1)})}var i=r.length>0,u=t.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:i,trash:u})},getUniqueIds:function(e){return e.length?e.map(function(t){return t.properties.id}).filter(function(t){return t!==void 0}).reduce(function(t,r){return t.add(r),t},new se).values():[]},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){be.enable(this)},onMouseMove:function(e,t){return Wt(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0},onMouseOut:function(e){return!e.dragMoving||this.fireUpdate()}};re.onTap=re.onClick=function(e,t){return mt(t)?this.clickAnywhere(e,t):yt(D.VERTEX)(t)?this.clickOnVertex(e,t):Wt(t)?this.clickOnFeature(e,t):void 0},re.clickAnywhere=function(e){var t=this,r=this.getSelectedIds();r.length&&(this.clearSelectedFeatures(),r.forEach(function(n){return t.doRender(n)})),be.enable(this),this.stopExtendedInteractions(e)},re.clickOnVertex=function(e,t){this.changeMode(M.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:d.MOVE})},re.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},re.clickOnFeature=function(e,t){var r=this;be.disable(this),this.stopExtendedInteractions(e);var n=vt(t),o=this.getSelectedIds(),i=t.featureTarget.properties.id,u=this.isSelected(i);if(!n&&u&&this.getFeature(i).type!==p.POINT)return this.changeMode(M.DIRECT_SELECT,{featureId:i});u&&n?(this.deselect(i),this.updateUIClasses({mouse:d.POINTER}),o.length===1&&be.enable(this)):!u&&n?(this.select(i),this.updateUIClasses({mouse:d.MOVE})):u||n||(o.forEach(function(v){return r.doRender(v)}),this.setSelected(i),this.updateUIClasses({mouse:d.MOVE})),this.doRender(i)},re.onMouseDown=function(e,t){return Be(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&br(t)?this.startBoxSelect(e,t):void 0},re.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Xt(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},re.onTouchStart=function(e,t){if(Be(t))return this.startOnActiveFeature(e,t)},re.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},re.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:d.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(m.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));var r=Xt(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),o=Math.max(e.boxSelectStartLocation.x,r.x),i=Math.min(e.boxSelectStartLocation.y,r.y),u=Math.max(e.boxSelectStartLocation.y,r.y),v="translate("+n+"px, "+i+"px)";e.boxSelectElement.style.transform=v,e.boxSelectElement.style.WebkitTransform=v,e.boxSelectElement.style.width=o-n+"px",e.boxSelectElement.style.height=u-i+"px"},re.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};er(this.getSelected(),r),e.dragMoveLocation=t.lngLat},re.onTouchEnd=re.onMouseUp=function(e,t){var r=this;if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){var n=[e.boxSelectStartLocation,Xt(t.originalEvent,this.map.getContainer())],o=this.featuresAt(null,n,"click"),i=this.getUniqueIds(o).filter(function(u){return!r.isSelected(u)});i.length&&(this.select(i),i.forEach(function(u){return r.doRender(u)}),this.updateUIClasses({mouse:d.MOVE}))}this.stopExtendedInteractions(e)},re.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?G.ACTIVE:G.INACTIVE,r(t),this.fireActionable(),t.properties.active===G.ACTIVE&&t.geometry.type!==p.POINT&&Et(t).forEach(r)},re.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},re.onCombineFeatures=function(){var e=this.getSelected();if(!(e.length===0||e.length<2)){for(var t=[],r=[],n=e[0].type.replace("Multi",""),o=0;o<e.length;o++){var i=e[o];if(i.type.replace("Multi","")!==n)return;i.type.includes("Multi")?i.getCoordinates().forEach(function(v){t.push(v)}):t.push(i.getCoordinates()),r.push(i.toGeoJSON())}if(r.length>1){var u=this.newFeature({type:p.FEATURE,properties:r[0].properties,geometry:{type:"Multi"+n,coordinates:t}});this.addFeature(u),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([u.id]),this.map.fire(k.COMBINE_FEATURES,{createdFeatures:[u.toGeoJSON()],deletedFeatures:r})}this.fireActionable()}},re.onUncombineFeatures=function(){var e=this,t=this.getSelected();if(t.length!==0){for(var r=[],n=[],o=function(u){var v=t[u];e.isInstanceOf("MultiFeature",v)&&(v.getFeatures().forEach(function(E){e.addFeature(E),E.properties=v.properties,r.push(E.toGeoJSON()),e.select([E.id])}),e.deleteFeature(v.id,{silent:!0}),n.push(v.toGeoJSON()))},i=0;i<t.length;i++)o(i);r.length>1&&this.map.fire(k.UNCOMBINE_FEATURES,{createdFeatures:r,deletedFeatures:n}),this.fireActionable()}};var Or=yt(D.VERTEX),wr=yt(D.MIDPOINT),Fe={fireUpdate:function(){this.map.fire(k.UPDATE,{action:V.CHANGE_COORDINATES,features:this.getSelected().map(function(e){return e.toGeoJSON()})})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);vt(t)||n!==-1?vt(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path):e.selectedCoordPaths=[r.coord_path];var o=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(o)},onMidpoint:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(e,t){return t.map(function(r){return{feature_id:e,coord_path:r}})},onFeature:function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,r){er(this.getSelected(),r),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,r){for(var n=e.selectedCoordPaths.map(function(v){return e.feature.getCoordinate(v)}),o=Qt(n.map(function(v){return{type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:v}}}),r),i=0;i<n.length;i++){var u=n[i];e.feature.updateCoordinate(e.selectedCoordPaths[i],u[0]+o.lng,u[1]+o.lat)}},clickNoTarget:function(){this.changeMode(M.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(M.SIMPLE_SELECT)},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){var t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===p.POINT)throw new TypeError("direct_select mode doesn't handle point features");var n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),be.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){be.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,r){e.featureId===t.properties.id?(t.properties.active=G.ACTIVE,r(t),Et(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=G.INACTIVE,r(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort(function(t,r){return r.localeCompare(t,"en",{numeric:!0})}).forEach(function(t){return e.feature.removeCoordinate(t)}),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(M.SIMPLE_SELECT,{}))},onMouseMove:function(e,t){var r=Be(t),n=Or(t),o=wr(t),i=e.selectedCoordPaths.length===0;return r&&i||n&&!i?this.updateUIClasses({mouse:d.MOVE}):this.updateUIClasses({mouse:d.NONE}),(n||r||o)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0},onMouseOut:function(e){return e.dragMoving&&this.fireUpdate(),!0}};Fe.onTouchStart=Fe.onMouseDown=function(e,t){return Or(t)?this.onVertex(e,t):Be(t)?this.onFeature(e,t):wr(t)?this.onMidpoint(e,t):void 0},Fe.onDrag=function(e,t){if(e.canDragMove===!0){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat}},Fe.onClick=function(e,t){return mt(t)?this.clickNoTarget(e,t):Be(t)?this.clickActiveFeature(e,t):Ht(t)?this.clickInactive(e,t):void this.stopDragging(e)},Fe.onTap=function(e,t){return mt(t)?this.clickNoTarget(e,t):Be(t)?this.clickActiveFeature(e,t):Ht(t)?this.clickInactive(e,t):void 0},Fe.onTouchEnd=Fe.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var Ce={};function wt(e,t){return!!e.lngLat&&e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]}Ce.onSetup=function(){var e=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:d.ADD}),this.activateUIButton(_.POINT),this.setActionableState({trash:!0}),{point:e}},Ce.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)},Ce.onTap=Ce.onClick=function(e,t){this.updateUIClasses({mouse:d.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(k.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.point.id]})},Ce.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})},Ce.toDisplayFeatures=function(e,t,r){var n=t.properties.id===e.point.id;if(t.properties.active=n?G.ACTIVE:G.INACTIVE,!n)return r(t)},Ce.onTrash=Ce.stopDrawingAndRemove,Ce.onKeyUp=function(e,t){if(bt(t)||_t(t))return this.stopDrawingAndRemove(e,t)};var je={onSetup:function(){var e=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),be.disable(this),this.updateUIClasses({mouse:d.ADD}),this.activateUIButton(_.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&wt(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:d.ADD}),e.polygon.updateCoordinate("0."+e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate("0."+e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate("0."+e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),ot(t)&&this.updateUIClasses({mouse:d.POINTER})}};je.onTap=je.onClick=function(e,t){return ot(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},je.onKeyUp=function(e,t){bt(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)):_t(t)&&this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.polygon.id]})},je.onStop=function(e){this.updateUIClasses({mouse:d.NONE}),be.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate("0."+e.currentVertexPosition),e.polygon.isValid()?this.map.fire(k.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT,{},{silent:!0})))},je.toDisplayFeatures=function(e,t,r){var n=t.properties.id===e.polygon.id;if(t.properties.active=n?G.ACTIVE:G.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length!==0){var o=t.geometry.coordinates[0].length;if(!(o<3)){if(t.properties.meta=D.FEATURE,r(We(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),o>3){var i=t.geometry.coordinates[0].length-3;r(We(e.polygon.id,t.geometry.coordinates[0][i],"0."+i,!1))}if(o<=4){var u=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:p.FEATURE,properties:t.properties,geometry:{coordinates:u,type:p.LINE_STRING}}),o===3)return}return r(t)}}},je.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)};var Ve={onSetup:function(e){var t,r,n=(e=e||{}).featureId,o="forward";if(n){if(!(t=this.getFeature(n)))throw new Error("Could not find a feature with the provided featureId");var i=e.from;if(i&&i.type==="Feature"&&i.geometry&&i.geometry.type==="Point"&&(i=i.geometry),i&&i.type==="Point"&&i.coordinates&&i.coordinates.length===2&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");var u=t.coordinates.length-1;if(t.coordinates[u][0]===i[0]&&t.coordinates[u][1]===i[1])r=u+1,t.addCoordinate.apply(t,[r].concat(t.coordinates[u]));else{if(t.coordinates[0][0]!==i[0]||t.coordinates[0][1]!==i[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");o="backwards",r=0,t.addCoordinate.apply(t,[r].concat(t.coordinates[0]))}}else t=this.newFeature({type:p.FEATURE,properties:{},geometry:{type:p.LINE_STRING,coordinates:[]}}),r=0,this.addFeature(t);return this.clearSelectedFeatures(),be.disable(this),this.updateUIClasses({mouse:d.ADD}),this.activateUIButton(_.LINE),this.setActionableState({trash:!0}),{line:t,currentVertexPosition:r,direction:o}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&wt(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&wt(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:d.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)},clickOnVertex:function(e){return this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.line.id]})},onMouseMove:function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),ot(t)&&this.updateUIClasses({mouse:d.POINTER})}};Ve.onTap=Ve.onClick=function(e,t){if(ot(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)},Ve.onKeyUp=function(e,t){_t(t)?this.changeMode(M.SIMPLE_SELECT,{featureIds:[e.line.id]}):bt(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT))},Ve.onStop=function(e){be.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(""+e.currentVertexPosition),e.line.isValid()?this.map.fire(k.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT,{},{silent:!0})))},Ve.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(M.SIMPLE_SELECT)},Ve.toDisplayFeatures=function(e,t,r){var n=t.properties.id===e.line.id;if(t.properties.active=n?G.ACTIVE:G.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=D.FEATURE,r(We(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],""+(e.direction==="forward"?t.geometry.coordinates.length-2:1),!1)),r(t))};var Ir={simple_select:re,direct_select:Fe,draw_point:Ce,draw_polygon:je,draw_line_string:Ve},zn={defaultMode:M.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:vr,modes:Ir,controls:{},userProperties:!1},Jn={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Yn={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Lr(e,t){return e.map(function(r){return r.source?r:Ne(r,{id:r.id+"."+t,source:t==="hot"?b.HOT:b.COLD})})}var tr={exports:{}};(function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,o="[object Arguments]",i="[object Array]",u="[object Boolean]",v="[object Date]",E="[object Error]",x="[object Function]",O="[object Map]",T="[object Number]",A="[object Object]",W="[object Promise]",R="[object RegExp]",K="[object Set]",y="[object String]",L="[object Symbol]",$="[object WeakMap]",ie="[object ArrayBuffer]",Q="[object DataView]",rr=/^\[object .+?Constructor\]$/,Wn=/^(?:0|[1-9]\d*)$/,Z={};Z["[object Float32Array]"]=Z["[object Float64Array]"]=Z["[object Int8Array]"]=Z["[object Int16Array]"]=Z["[object Int32Array]"]=Z["[object Uint8Array]"]=Z["[object Uint8ClampedArray]"]=Z["[object Uint16Array]"]=Z["[object Uint32Array]"]=!0,Z[o]=Z[i]=Z[ie]=Z[u]=Z[Q]=Z[v]=Z[E]=Z[x]=Z[O]=Z[T]=Z[A]=Z[R]=Z[K]=Z[y]=Z[$]=!1;var Fr=typeof rt=="object"&&rt&&rt.Object===Object&&rt,Xn=typeof self=="object"&&self&&self.Object===Object&&self,Oe=Fr||Xn||Function("return this")(),Ar=t&&!t.nodeType&&t,Rr=Ar&&e&&!e.nodeType&&e,kr=Rr&&Rr.exports===Ar,nr=kr&&Fr.process,Dr=function(){try{return nr&&nr.binding&&nr.binding("util")}catch{}}(),Ur=Dr&&Dr.isTypedArray;function Kn(c,f){for(var S=-1,N=c==null?0:c.length;++S<N;)if(f(c[S],S,c))return!0;return!1}function Qn(c){var f=-1,S=Array(c.size);return c.forEach(function(N,H){S[++f]=[H,N]}),S}function eo(c){var f=-1,S=Array(c.size);return c.forEach(function(N){S[++f]=N}),S}var Br,jr,Vr,to=Array.prototype,ro=Function.prototype,Lt=Object.prototype,or=Oe["__core-js_shared__"],Gr=ro.toString,Te=Lt.hasOwnProperty,$r=(Br=/[^.]+$/.exec(or&&or.keys&&or.keys.IE_PROTO||""))?"Symbol(src)_1."+Br:"",zr=Lt.toString,no=RegExp("^"+Gr.call(Te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jr=kr?Oe.Buffer:void 0,Pt=Oe.Symbol,Yr=Oe.Uint8Array,qr=Lt.propertyIsEnumerable,oo=to.splice,Ge=Pt?Pt.toStringTag:void 0,Zr=Object.getOwnPropertySymbols,io=Jr?Jr.isBuffer:void 0,ao=(jr=Object.keys,Vr=Object,function(c){return jr(Vr(c))}),ir=Ke(Oe,"DataView"),it=Ke(Oe,"Map"),ar=Ke(Oe,"Promise"),sr=Ke(Oe,"Set"),ur=Ke(Oe,"WeakMap"),at=Ke(Object,"create"),so=Je(ir),uo=Je(it),co=Je(ar),lo=Je(sr),fo=Je(ur),Hr=Pt?Pt.prototype:void 0,cr=Hr?Hr.valueOf:void 0;function $e(c){var f=-1,S=c==null?0:c.length;for(this.clear();++f<S;){var N=c[f];this.set(N[0],N[1])}}function we(c){var f=-1,S=c==null?0:c.length;for(this.clear();++f<S;){var N=c[f];this.set(N[0],N[1])}}function ze(c){var f=-1,S=c==null?0:c.length;for(this.clear();++f<S;){var N=c[f];this.set(N[0],N[1])}}function Nt(c){var f=-1,S=c==null?0:c.length;for(this.__data__=new ze;++f<S;)this.add(c[f])}function Ae(c){var f=this.__data__=new we(c);this.size=f.size}function po(c,f){var S=Rt(c),N=!S&&vo(c),H=!S&&!N&&lr(c),j=!S&&!N&&!H&&on(c),X=S||N||H||j,ee=X?function(oe,Me){for(var Ie=-1,le=Array(oe);++Ie<oe;)le[Ie]=Me(Ie);return le}(c.length,String):[],_e=ee.length;for(var ne in c)!f&&!Te.call(c,ne)||X&&(ne=="length"||H&&(ne=="offset"||ne=="parent")||j&&(ne=="buffer"||ne=="byteLength"||ne=="byteOffset")||mo(ne,_e))||ee.push(ne);return ee}function Ft(c,f){for(var S=c.length;S--;)if(en(c[S][0],f))return S;return-1}function st(c){return c==null?c===void 0?"[object Undefined]":"[object Null]":Ge&&Ge in Object(c)?function(f){var S=Te.call(f,Ge),N=f[Ge];try{f[Ge]=void 0;var H=!0}catch{}var j=zr.call(f);return H&&(S?f[Ge]=N:delete f[Ge]),j}(c):function(f){return zr.call(f)}(c)}function Wr(c){return ut(c)&&st(c)==o}function Xr(c,f,S,N,H){return c===f||(c==null||f==null||!ut(c)&&!ut(f)?c!=c&&f!=f:function(j,X,ee,_e,ne,oe){var Me=Rt(j),Ie=Rt(X),le=Me?i:Re(j),Le=Ie?i:Re(X),Qe=(le=le==o?A:le)==A,kt=(Le=Le==o?A:Le)==A,et=le==Le;if(et&&lr(j)){if(!lr(X))return!1;Me=!0,Qe=!1}if(et&&!Qe)return oe||(oe=new Ae),Me||on(j)?Kr(j,X,ee,_e,ne,oe):function(J,z,Dt,ke,dr,ye,Pe){switch(Dt){case Q:if(J.byteLength!=z.byteLength||J.byteOffset!=z.byteOffset)return!1;J=J.buffer,z=z.buffer;case ie:return!(J.byteLength!=z.byteLength||!ye(new Yr(J),new Yr(z)));case u:case v:case T:return en(+J,+z);case E:return J.name==z.name&&J.message==z.message;case R:case y:return J==z+"";case O:var De=Qn;case K:var lt=1&ke;if(De||(De=eo),J.size!=z.size&&!lt)return!1;var Ut=Pe.get(J);if(Ut)return Ut==z;ke|=2,Pe.set(J,z);var tt=Kr(De(J),De(z),ke,dr,ye,Pe);return Pe.delete(J),tt;case L:if(cr)return cr.call(J)==cr.call(z)}return!1}(j,X,le,ee,_e,ne,oe);if(!(1&ee)){var ct=Qe&&Te.call(j,"__wrapped__"),an=kt&&Te.call(X,"__wrapped__");if(ct||an){var _o=ct?j.value():j,Eo=an?X.value():X;return oe||(oe=new Ae),ne(_o,Eo,ee,_e,oe)}}return et?(oe||(oe=new Ae),function(J,z,Dt,ke,dr,ye){var Pe=1&Dt,De=Qr(J),lt=De.length,Ut=Qr(z).length;if(lt!=Ut&&!Pe)return!1;for(var tt=lt;tt--;){var Ye=De[tt];if(!(Pe?Ye in z:Te.call(z,Ye)))return!1}var sn=ye.get(J);if(sn&&ye.get(z))return sn==z;var Bt=!0;ye.set(J,z),ye.set(z,J);for(var fr=Pe;++tt<lt;){var jt=J[Ye=De[tt]],Vt=z[Ye];if(ke)var un=Pe?ke(Vt,jt,Ye,z,J,ye):ke(jt,Vt,Ye,J,z,ye);if(!(un===void 0?jt===Vt||dr(jt,Vt,Dt,ke,ye):un)){Bt=!1;break}fr||(fr=Ye=="constructor")}if(Bt&&!fr){var Gt=J.constructor,$t=z.constructor;Gt==$t||!("constructor"in J)||!("constructor"in z)||typeof Gt=="function"&&Gt instanceof Gt&&typeof $t=="function"&&$t instanceof $t||(Bt=!1)}return ye.delete(J),ye.delete(z),Bt}(j,X,ee,_e,ne,oe)):!1}(c,f,S,N,Xr,H))}function ho(c){return!(!nn(c)||function(f){return!!$r&&$r in f}(c))&&(tn(c)?no:rr).test(Je(c))}function go(c){if(S=(f=c)&&f.constructor,N=typeof S=="function"&&S.prototype||Lt,f!==N)return ao(c);var f,S,N,H=[];for(var j in Object(c))Te.call(c,j)&&j!="constructor"&&H.push(j);return H}function Kr(c,f,S,N,H,j){var X=1&S,ee=c.length,_e=f.length;if(ee!=_e&&!(X&&_e>ee))return!1;var ne=j.get(c);if(ne&&j.get(f))return ne==f;var oe=-1,Me=!0,Ie=2&S?new Nt:void 0;for(j.set(c,f),j.set(f,c);++oe<ee;){var le=c[oe],Le=f[oe];if(N)var Qe=X?N(Le,le,oe,f,c,j):N(le,Le,oe,c,f,j);if(Qe!==void 0){if(Qe)continue;Me=!1;break}if(Ie){if(!Kn(f,function(kt,et){if(ct=et,!Ie.has(ct)&&(le===kt||H(le,kt,S,N,j)))return Ie.push(et);var ct})){Me=!1;break}}else if(le!==Le&&!H(le,Le,S,N,j)){Me=!1;break}}return j.delete(c),j.delete(f),Me}function Qr(c){return function(f,S,N){var H=S(f);return Rt(f)?H:function(j,X){for(var ee=-1,_e=X.length,ne=j.length;++ee<_e;)j[ne+ee]=X[ee];return j}(H,N(f))}(c,bo,yo)}function At(c,f){var S,N,H=c.__data__;return((N=typeof(S=f))=="string"||N=="number"||N=="symbol"||N=="boolean"?S!=="__proto__":S===null)?H[typeof f=="string"?"string":"hash"]:H.map}function Ke(c,f){var S=function(N,H){return N==null?void 0:N[H]}(c,f);return ho(S)?S:void 0}$e.prototype.clear=function(){this.__data__=at?at(null):{},this.size=0},$e.prototype.delete=function(c){var f=this.has(c)&&delete this.__data__[c];return this.size-=f?1:0,f},$e.prototype.get=function(c){var f=this.__data__;if(at){var S=f[c];return S===r?void 0:S}return Te.call(f,c)?f[c]:void 0},$e.prototype.has=function(c){var f=this.__data__;return at?f[c]!==void 0:Te.call(f,c)},$e.prototype.set=function(c,f){var S=this.__data__;return this.size+=this.has(c)?0:1,S[c]=at&&f===void 0?r:f,this},we.prototype.clear=function(){this.__data__=[],this.size=0},we.prototype.delete=function(c){var f=this.__data__,S=Ft(f,c);return!(S<0)&&(S==f.length-1?f.pop():oo.call(f,S,1),--this.size,!0)},we.prototype.get=function(c){var f=this.__data__,S=Ft(f,c);return S<0?void 0:f[S][1]},we.prototype.has=function(c){return Ft(this.__data__,c)>-1},we.prototype.set=function(c,f){var S=this.__data__,N=Ft(S,c);return N<0?(++this.size,S.push([c,f])):S[N][1]=f,this},ze.prototype.clear=function(){this.size=0,this.__data__={hash:new $e,map:new(it||we),string:new $e}},ze.prototype.delete=function(c){var f=At(this,c).delete(c);return this.size-=f?1:0,f},ze.prototype.get=function(c){return At(this,c).get(c)},ze.prototype.has=function(c){return At(this,c).has(c)},ze.prototype.set=function(c,f){var S=At(this,c),N=S.size;return S.set(c,f),this.size+=S.size==N?0:1,this},Nt.prototype.add=Nt.prototype.push=function(c){return this.__data__.set(c,r),this},Nt.prototype.has=function(c){return this.__data__.has(c)},Ae.prototype.clear=function(){this.__data__=new we,this.size=0},Ae.prototype.delete=function(c){var f=this.__data__,S=f.delete(c);return this.size=f.size,S},Ae.prototype.get=function(c){return this.__data__.get(c)},Ae.prototype.has=function(c){return this.__data__.has(c)},Ae.prototype.set=function(c,f){var S=this.__data__;if(S instanceof we){var N=S.__data__;if(!it||N.length<199)return N.push([c,f]),this.size=++S.size,this;S=this.__data__=new ze(N)}return S.set(c,f),this.size=S.size,this};var yo=Zr?function(c){return c==null?[]:(c=Object(c),function(f,S){for(var N=-1,H=f==null?0:f.length,j=0,X=[];++N<H;){var ee=f[N];S(ee,N,f)&&(X[j++]=ee)}return X}(Zr(c),function(f){return qr.call(c,f)}))}:function(){return[]},Re=st;function mo(c,f){return!!(f=f??n)&&(typeof c=="number"||Wn.test(c))&&c>-1&&c%1==0&&c<f}function Je(c){if(c!=null){try{return Gr.call(c)}catch{}try{return c+""}catch{}}return""}function en(c,f){return c===f||c!=c&&f!=f}(ir&&Re(new ir(new ArrayBuffer(1)))!=Q||it&&Re(new it)!=O||ar&&Re(ar.resolve())!=W||sr&&Re(new sr)!=K||ur&&Re(new ur)!=$)&&(Re=function(c){var f=st(c),S=f==A?c.constructor:void 0,N=S?Je(S):"";if(N)switch(N){case so:return Q;case uo:return O;case co:return W;case lo:return K;case fo:return $}return f});var vo=Wr(function(){return arguments}())?Wr:function(c){return ut(c)&&Te.call(c,"callee")&&!qr.call(c,"callee")},Rt=Array.isArray,lr=io||function(){return!1};function tn(c){if(!nn(c))return!1;var f=st(c);return f==x||f=="[object GeneratorFunction]"||f=="[object AsyncFunction]"||f=="[object Proxy]"}function rn(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=n}function nn(c){var f=typeof c;return c!=null&&(f=="object"||f=="function")}function ut(c){return c!=null&&typeof c=="object"}var on=Ur?function(c){return function(f){return c(f)}}(Ur):function(c){return ut(c)&&rn(c.length)&&!!Z[st(c)]};function bo(c){return(f=c)!=null&&rn(f.length)&&!tn(f)?po(c):go(c);var f}e.exports=function(c,f){return Xr(c,f)}})(tr,tr.exports);var Pr=C(tr.exports);function Nr(e,t){return e.length===t.length&&JSON.stringify(e.map(function(r){return r}).sort())===JSON.stringify(t.map(function(r){return r}).sort())}var qn={Polygon:he,LineString:xe,Point:Ue,MultiPolygon:fe,MultiLineString:fe,MultiPoint:fe},Zn=Object.freeze({__proto__:null,CommonSelectors:wn,constrainFeatureMovement:Qt,createMidPoint:_r,createSupplementaryPoints:Et,createVertex:We,doubleClickZoom:be,euclideanDistance:zt,featuresAt:Se,getFeatureAtAndSetCursors:ht,isClick:Jt,isEventAtCoordinates:wt,isTap:Yt,mapEventToBoundingBox:Ze,ModeHandler:g,moveFeatures:er,sortFeatures:de,stringSetsAreEqual:Nr,StringSet:se,theme:vr,toDenseArray:nt}),Hn=function(e,t){var r={options:e=function(o){o===void 0&&(o={});var i=Ne(o);return o.controls||(i.controls={}),o.displayControlsDefault===!1?i.controls=Ne(Yn,o.controls):i.controls=Ne(Jn,o.controls),(i=Ne(zn,i)).styles=Lr(i.styles,"cold").concat(Lr(i.styles,"hot")),i}(e)};t=function(o,i){return i.modes=M,i.getFeatureIdsAt=function(u){return Se.click({point:u},null,o).map(function(v){return v.properties.id})},i.getSelectedIds=function(){return o.store.getSelectedIds()},i.getSelected=function(){return{type:p.FEATURE_COLLECTION,features:o.store.getSelectedIds().map(function(u){return o.store.get(u)}).map(function(u){return u.toGeoJSON()})}},i.getSelectedPoints=function(){return{type:p.FEATURE_COLLECTION,features:o.store.getSelectedCoordinates().map(function(u){return{type:p.FEATURE,properties:{},geometry:{type:p.POINT,coordinates:u.coordinates}}})}},i.set=function(u){if(u.type===void 0||u.type!==p.FEATURE_COLLECTION||!Array.isArray(u.features))throw new Error("Invalid FeatureCollection");var v=o.store.createRenderBatch(),E=o.store.getAllIds().slice(),x=i.add(u),O=new se(x);return(E=E.filter(function(T){return!O.has(T)})).length&&i.delete(E),v(),x},i.add=function(u){var v=JSON.parse(JSON.stringify(Nn(u))).features.map(function(E){if(E.id=E.id||Zt(),E.geometry===null)throw new Error("Invalid geometry: null");if(o.store.get(E.id)===void 0||o.store.get(E.id).type!==E.geometry.type){var x=qn[E.geometry.type];if(x===void 0)throw new Error("Invalid geometry type: "+E.geometry.type+".");var O=new x(o,E);o.store.add(O)}else{var T=o.store.get(E.id);T.properties=E.properties,Pr(T.properties,E.properties)||o.store.featureChanged(T.id),Pr(T.getCoordinates(),E.geometry.coordinates)||T.incomingCoords(E.geometry.coordinates)}return E.id});return o.store.render(),v},i.get=function(u){var v=o.store.get(u);if(v)return v.toGeoJSON()},i.getAll=function(){return{type:p.FEATURE_COLLECTION,features:o.store.getAll().map(function(u){return u.toGeoJSON()})}},i.delete=function(u){return o.store.delete(u,{silent:!0}),i.getMode()!==M.DIRECT_SELECT||o.store.getSelectedIds().length?o.store.render():o.events.changeMode(M.SIMPLE_SELECT,void 0,{silent:!0}),i},i.deleteAll=function(){return o.store.delete(o.store.getAllIds(),{silent:!0}),i.getMode()===M.DIRECT_SELECT?o.events.changeMode(M.SIMPLE_SELECT,void 0,{silent:!0}):o.store.render(),i},i.changeMode=function(u,v){return v===void 0&&(v={}),u===M.SIMPLE_SELECT&&i.getMode()===M.SIMPLE_SELECT?(Nr(v.featureIds||[],o.store.getSelectedIds())||(o.store.setSelected(v.featureIds,{silent:!0}),o.store.render()),i):(u===M.DIRECT_SELECT&&i.getMode()===M.DIRECT_SELECT&&v.featureId===o.store.getSelectedIds()[0]||o.events.changeMode(u,v,{silent:!0}),i)},i.getMode=function(){return o.events.getMode()},i.trash=function(){return o.events.trash({silent:!0}),i},i.combineFeatures=function(){return o.events.combineFeatures({silent:!0}),i},i.uncombineFeatures=function(){return o.events.uncombineFeatures({silent:!0}),i},i.setFeatureProperty=function(u,v,E){return o.store.setFeatureProperty(u,v,E),i},i}(r,t),r.api=t;var n=On(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=_,t.options=e,t};function It(e){Hn(e,this)}return It.modes=Ir,It.constants=ae,It.lib=Zn,It})})(gn);var Io=gn.exports;const Lo=hn(Io);function Po(h,s,g){g===void 0&&(g={});var C=pr(h),w=pr(s),I=qe(w[1]-C[1]),F=qe(w[0]-C[0]),P=qe(C[1]),U=qe(w[1]),a=Math.pow(Math.sin(I/2),2)+Math.pow(Math.sin(F/2),2)*Math.cos(P)*Math.cos(U);return So(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),g.units)}function yn(h,s,g){if(h!==null)for(var C,w,I,F,P,U,a,l=0,m=0,b,d=h.type,_=d==="FeatureCollection",p=d==="Feature",M=_?h.features.length:1,k=0;k<M;k++){a=_?h.features[k].geometry:p?h.geometry:h,b=a?a.type==="GeometryCollection":!1,P=b?a.geometries.length:1;for(var V=0;V<P;V++){var D=0,G=0;if(F=b?a.geometries[V]:a,F!==null){U=F.coordinates;var Y=F.type;switch(l=g&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(s(U,m,k,D,G)===!1)return!1;m++,D++;break;case"LineString":case"MultiPoint":for(C=0;C<U.length;C++){if(s(U[C],m,k,D,G)===!1)return!1;m++,Y==="MultiPoint"&&D++}Y==="LineString"&&D++;break;case"Polygon":case"MultiLineString":for(C=0;C<U.length;C++){for(w=0;w<U[C].length-l;w++){if(s(U[C][w],m,k,D,G)===!1)return!1;m++}Y==="MultiLineString"&&D++,Y==="Polygon"&&G++}Y==="Polygon"&&D++;break;case"MultiPolygon":for(C=0;C<U.length;C++){for(G=0,w=0;w<U[C].length;w++){for(I=0;I<U[C][w].length-l;I++){if(s(U[C][w][I],m,k,D,G)===!1)return!1;m++}G++}D++}break;case"GeometryCollection":for(C=0;C<F.geometries.length;C++)if(yn(F.geometries[C],s,g)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function No(h,s){var g,C,w,I,F,P,U,a,l,m,b=0,d=h.type==="FeatureCollection",_=h.type==="Feature",p=d?h.features.length:1;for(g=0;g<p;g++){for(P=d?h.features[g].geometry:_?h.geometry:h,a=d?h.features[g].properties:_?h.properties:{},l=d?h.features[g].bbox:_?h.bbox:void 0,m=d?h.features[g].id:_?h.id:void 0,U=P?P.type==="GeometryCollection":!1,F=U?P.geometries.length:1,w=0;w<F;w++){if(I=U?P.geometries[w]:P,I===null){if(s(null,b,a,l,m)===!1)return!1;continue}switch(I.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(I,b,a,l,m)===!1)return!1;break}case"GeometryCollection":{for(C=0;C<I.geometries.length;C++)if(s(I.geometries[C],b,a,l,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function Fo(h,s){No(h,function(g,C,w,I,F){var P=g===null?null:g.type;switch(P){case null:case"Point":case"LineString":case"Polygon":return s(ft(g,w,{bbox:I,id:F}),C,0)===!1?!1:void 0}var U;switch(P){case"MultiPoint":U="Point";break;case"MultiLineString":U="LineString";break;case"MultiPolygon":U="Polygon";break}for(var a=0;a<g.coordinates.length;a++){var l=g.coordinates[a],m={type:U,coordinates:l};if(s(ft(m,w),C,a)===!1)return!1}})}function Ao(h,s){Fo(h,function(g,C,w){var I=0;if(g.geometry){var F=g.geometry.type;if(!(F==="Point"||F==="MultiPoint")){var P,U=0,a=0,l=0;if(yn(g,function(m,b,d,_,p){if(P===void 0||C>U||_>a||p>l){P=m,U=C,a=_,l=p,I=0;return}var M=Mo([P,m],g.properties);if(s(M,C,w,p,I)===!1)return!1;I++,P=m})===!1)return!1}}})}function Ro(h,s,g){var C=g,w=!1;return Ao(h,function(I,F,P,U,a){w===!1&&g===void 0?C=I:C=s(C,I,F,P,U,a),w=!0}),C}function mn(h,s){return s===void 0&&(s={}),Ro(h,function(g,C){var w=C.geometry.coordinates;return g+Po(w[0],w[1],s)},0)}var vn={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(h){(function(s,g){h.exports?h.exports=g():s.numeral=g()})(rt,function(){var s,g,C="2.0.6",w={},I={},F={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},P={currentLocale:F.currentLocale,zeroFormat:F.zeroFormat,nullFormat:F.nullFormat,defaultFormat:F.defaultFormat,scalePercentBy100:F.scalePercentBy100};function U(a,l){this._input=a,this._value=l}return s=function(a){var l,m,b,d;if(s.isNumeral(a))l=a.value();else if(a===0||typeof a>"u")l=0;else if(a===null||g.isNaN(a))l=null;else if(typeof a=="string")if(P.zeroFormat&&a===P.zeroFormat)l=0;else if(P.nullFormat&&a===P.nullFormat||!a.replace(/[^0-9]+/g,"").length)l=null;else{for(m in w)if(d=typeof w[m].regexps.unformat=="function"?w[m].regexps.unformat():w[m].regexps.unformat,d&&a.match(d)){b=w[m].unformat;break}b=b||s._.stringToNumber,l=b(a)}else l=Number(a)||null;return new U(a,l)},s.version=C,s.isNumeral=function(a){return a instanceof U},s._=g={numberToFormat:function(a,l,m){var b=I[s.options.currentLocale],d=!1,_=!1,p=0,M="",k=1e12,V=1e9,D=1e6,G=1e3,Y="",Ee=!1,ae,me,te,de,Ze,se,ve;if(a=a||0,me=Math.abs(a),s._.includes(l,"(")?(d=!0,l=l.replace(/[\(|\)]/g,"")):(s._.includes(l,"+")||s._.includes(l,"-"))&&(Ze=s._.includes(l,"+")?l.indexOf("+"):a<0?l.indexOf("-"):-1,l=l.replace(/[\+|\-]/g,"")),s._.includes(l,"a")&&(ae=l.match(/a(k|m|b|t)?/),ae=ae?ae[1]:!1,s._.includes(l," a")&&(M=" "),l=l.replace(new RegExp(M+"a[kmbt]?"),""),me>=k&&!ae||ae==="t"?(M+=b.abbreviations.trillion,a=a/k):me<k&&me>=V&&!ae||ae==="b"?(M+=b.abbreviations.billion,a=a/V):me<V&&me>=D&&!ae||ae==="m"?(M+=b.abbreviations.million,a=a/D):(me<D&&me>=G&&!ae||ae==="k")&&(M+=b.abbreviations.thousand,a=a/G)),s._.includes(l,"[.]")&&(_=!0,l=l.replace("[.]",".")),te=a.toString().split(".")[0],de=l.split(".")[1],se=l.indexOf(","),p=(l.split(".")[0].split(",")[0].match(/0/g)||[]).length,de?(s._.includes(de,"[")?(de=de.replace("]",""),de=de.split("["),Y=s._.toFixed(a,de[0].length+de[1].length,m,de[1].length)):Y=s._.toFixed(a,de.length,m),te=Y.split(".")[0],s._.includes(Y,".")?Y=b.delimiters.decimal+Y.split(".")[1]:Y="",_&&Number(Y.slice(1))===0&&(Y="")):te=s._.toFixed(a,0,m),M&&!ae&&Number(te)>=1e3&&M!==b.abbreviations.trillion)switch(te=String(Number(te)/1e3),M){case b.abbreviations.thousand:M=b.abbreviations.million;break;case b.abbreviations.million:M=b.abbreviations.billion;break;case b.abbreviations.billion:M=b.abbreviations.trillion;break}if(s._.includes(te,"-")&&(te=te.slice(1),Ee=!0),te.length<p)for(var Se=p-te.length;Se>0;Se--)te="0"+te;return se>-1&&(te=te.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+b.delimiters.thousands)),l.indexOf(".")===0&&(te=""),ve=te+Y+(M||""),d?ve=(d&&Ee?"(":"")+ve+(d&&Ee?")":""):Ze>=0?ve=Ze===0?(Ee?"-":"+")+ve:ve+(Ee?"-":"+"):Ee&&(ve="-"+ve),ve},stringToNumber:function(a){var l=I[P.currentLocale],m=a,b={thousand:3,million:6,billion:9,trillion:12},d,_,p;if(P.zeroFormat&&a===P.zeroFormat)_=0;else if(P.nullFormat&&a===P.nullFormat||!a.replace(/[^0-9]+/g,"").length)_=null;else{_=1,l.delimiters.decimal!=="."&&(a=a.replace(/\./g,"").replace(l.delimiters.decimal,"."));for(d in b)if(p=new RegExp("[^a-zA-Z]"+l.abbreviations[d]+"(?:\\)|(\\"+l.currency.symbol+")?(?:\\))?)?$"),m.match(p)){_*=Math.pow(10,b[d]);break}_*=(a.split("-").length+Math.min(a.split("(").length-1,a.split(")").length-1))%2?1:-1,a=a.replace(/[^0-9\.]+/g,""),_*=Number(a)}return _},isNaN:function(a){return typeof a=="number"&&isNaN(a)},includes:function(a,l){return a.indexOf(l)!==-1},insert:function(a,l,m){return a.slice(0,m)+l+a.slice(m)},reduce:function(a,l){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof l!="function")throw new TypeError(l+" is not a function");var m=Object(a),b=m.length>>>0,d=0,_;if(arguments.length===3)_=arguments[2];else{for(;d<b&&!(d in m);)d++;if(d>=b)throw new TypeError("Reduce of empty array with no initial value");_=m[d++]}for(;d<b;d++)d in m&&(_=l(_,m[d],d,m));return _},multiplier:function(a){var l=a.toString().split(".");return l.length<2?1:Math.pow(10,l[1].length)},correctionFactor:function(){var a=Array.prototype.slice.call(arguments);return a.reduce(function(l,m){var b=g.multiplier(m);return l>b?l:b},1)},toFixed:function(a,l,m,b){var d=a.toString().split("."),_=l-(b||0),p,M,k,V;return d.length===2?p=Math.min(Math.max(d[1].length,_),l):p=_,k=Math.pow(10,p),V=(m(a+"e+"+p)/k).toFixed(p),b>l-p&&(M=new RegExp("\\.?0{1,"+(b-(l-p))+"}$"),V=V.replace(M,"")),V}},s.options=P,s.formats=w,s.locales=I,s.locale=function(a){return a&&(P.currentLocale=a.toLowerCase()),P.currentLocale},s.localeData=function(a){if(!a)return I[P.currentLocale];if(a=a.toLowerCase(),!I[a])throw new Error("Unknown locale : "+a);return I[a]},s.reset=function(){for(var a in F)P[a]=F[a]},s.zeroFormat=function(a){P.zeroFormat=typeof a=="string"?a:null},s.nullFormat=function(a){P.nullFormat=typeof a=="string"?a:null},s.defaultFormat=function(a){P.defaultFormat=typeof a=="string"?a:"0.0"},s.register=function(a,l,m){if(l=l.toLowerCase(),this[a+"s"][l])throw new TypeError(l+" "+a+" already registered.");return this[a+"s"][l]=m,m},s.validate=function(a,l){var m,b,d,_,p,M,k,V;if(typeof a!="string"&&(a+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",a)),a=a.trim(),a.match(/^\d+$/))return!0;if(a==="")return!1;try{k=s.localeData(l)}catch{k=s.localeData(s.locale())}return d=k.currency.symbol,p=k.abbreviations,m=k.delimiters.decimal,k.delimiters.thousands==="."?b="\\.":b=k.delimiters.thousands,V=a.match(/^[^\d]+/),V!==null&&(a=a.substr(1),V[0]!==d)||(V=a.match(/[^\d]+$/),V!==null&&(a=a.slice(0,-1),V[0]!==p.thousand&&V[0]!==p.million&&V[0]!==p.billion&&V[0]!==p.trillion))?!1:(M=new RegExp(b+"{2}"),a.match(/[^\d.,]/g)?!1:(_=a.split(m),_.length>2?!1:_.length<2?!!_[0].match(/^\d+.*\d$/)&&!_[0].match(M):_[0].length===1?!!_[0].match(/^\d+$/)&&!_[0].match(M)&&!!_[1].match(/^\d+$/):!!_[0].match(/^\d+.*\d$/)&&!_[0].match(M)&&!!_[1].match(/^\d+$/)))},s.fn=U.prototype={clone:function(){return s(this)},format:function(a,l){var m=this._value,b=a||P.defaultFormat,d,_,p;if(l=l||Math.round,m===0&&P.zeroFormat!==null)_=P.zeroFormat;else if(m===null&&P.nullFormat!==null)_=P.nullFormat;else{for(d in w)if(b.match(w[d].regexps.format)){p=w[d].format;break}p=p||s._.numberToFormat,_=p(m,b,l)}return _},value:function(){return this._value},input:function(){return this._input},set:function(a){return this._value=Number(a),this},add:function(a){var l=g.correctionFactor.call(null,this._value,a);function m(b,d,_,p){return b+Math.round(l*d)}return this._value=g.reduce([this._value,a],m,0)/l,this},subtract:function(a){var l=g.correctionFactor.call(null,this._value,a);function m(b,d,_,p){return b-Math.round(l*d)}return this._value=g.reduce([a],m,Math.round(this._value*l))/l,this},multiply:function(a){function l(m,b,d,_){var p=g.correctionFactor(m,b);return Math.round(m*p)*Math.round(b*p)/Math.round(p*p)}return this._value=g.reduce([this._value,a],l,1),this},divide:function(a){function l(m,b,d,_){var p=g.correctionFactor(m,b);return Math.round(m*p)/Math.round(b*p)}return this._value=g.reduce([this._value,a],l),this},difference:function(a){return Math.abs(s(this._value).subtract(a).value())}},s.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var l=a%10;return~~(a%100/10)===1?"th":l===1?"st":l===2?"nd":l===3?"rd":"th"},currency:{symbol:"$"}}),function(){s.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(a,l,m){var b=s._.includes(l," BPS")?" ":"",d;return a=a*1e4,l=l.replace(/\s?BPS/,""),d=s._.numberToFormat(a,l,m),s._.includes(d,")")?(d=d.split(""),d.splice(-1,0,b+"BPS"),d=d.join("")):d=d+b+"BPS",d},unformat:function(a){return+(s._.stringToNumber(a)*1e-4).toFixed(15)}})}(),function(){var a={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},l={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},m=a.suffixes.concat(l.suffixes.filter(function(d){return a.suffixes.indexOf(d)<0})),b=m.join("|");b="("+b.replace("B","B(?!PS)")+")",s.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(b)},format:function(d,_,p){var M,k=s._.includes(_,"ib")?l:a,V=s._.includes(_," b")||s._.includes(_," ib")?" ":"",D,G,Y;for(_=_.replace(/\s?i?b/,""),D=0;D<=k.suffixes.length;D++)if(G=Math.pow(k.base,D),Y=Math.pow(k.base,D+1),d===null||d===0||d>=G&&d<Y){V+=k.suffixes[D],G>0&&(d=d/G);break}return M=s._.numberToFormat(d,_,p),M+V},unformat:function(d){var _=s._.stringToNumber(d),p,M;if(_){for(p=a.suffixes.length-1;p>=0;p--){if(s._.includes(d,a.suffixes[p])){M=Math.pow(a.base,p);break}if(s._.includes(d,l.suffixes[p])){M=Math.pow(l.base,p);break}}_*=M||1}return _}})}(),function(){s.register("format","currency",{regexps:{format:/(\$)/},format:function(a,l,m){var b=s.locales[s.options.currentLocale],d={before:l.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:l.match(/([\+|\-|\)|\s|\$]*)$/)[0]},_,p,M;for(l=l.replace(/\s?\$\s?/,""),_=s._.numberToFormat(a,l,m),a>=0?(d.before=d.before.replace(/[\-\(]/,""),d.after=d.after.replace(/[\-\)]/,"")):a<0&&!s._.includes(d.before,"-")&&!s._.includes(d.before,"(")&&(d.before="-"+d.before),M=0;M<d.before.length;M++)switch(p=d.before[M],p){case"$":_=s._.insert(_,b.currency.symbol,M);break;case" ":_=s._.insert(_," ",M+b.currency.symbol.length-1);break}for(M=d.after.length-1;M>=0;M--)switch(p=d.after[M],p){case"$":_=M===d.after.length-1?_+b.currency.symbol:s._.insert(_,b.currency.symbol,-(d.after.length-(1+M)));break;case" ":_=M===d.after.length-1?_+" ":s._.insert(_," ",-(d.after.length-(1+M)+b.currency.symbol.length-1));break}return _}})}(),function(){s.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(a,l,m){var b,d=typeof a=="number"&&!s._.isNaN(a)?a.toExponential():"0e+0",_=d.split("e");return l=l.replace(/e[\+|\-]{1}0/,""),b=s._.numberToFormat(Number(_[0]),l,m),b+"e"+_[1]},unformat:function(a){var l=s._.includes(a,"e+")?a.split("e+"):a.split("e-"),m=Number(l[0]),b=Number(l[1]);b=s._.includes(a,"e-")?b*=-1:b;function d(_,p,M,k){var V=s._.correctionFactor(_,p),D=_*V*(p*V)/(V*V);return D}return s._.reduce([m,Math.pow(10,b)],d,1)}})}(),function(){s.register("format","ordinal",{regexps:{format:/(o)/},format:function(a,l,m){var b=s.locales[s.options.currentLocale],d,_=s._.includes(l," o")?" ":"";return l=l.replace(/\s?o/,""),_+=b.ordinal(a),d=s._.numberToFormat(a,l,m),d+_}})}(),function(){s.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(a,l,m){var b=s._.includes(l," %")?" ":"",d;return s.options.scalePercentBy100&&(a=a*100),l=l.replace(/\s?\%/,""),d=s._.numberToFormat(a,l,m),s._.includes(d,")")?(d=d.split(""),d.splice(-1,0,b+"%"),d=d.join("")):d=d+b+"%",d},unformat:function(a){var l=s._.stringToNumber(a);return s.options.scalePercentBy100?l*.01:l}})}(),function(){s.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(a,l,m){var b=Math.floor(a/60/60),d=Math.floor((a-b*60*60)/60),_=Math.round(a-b*60*60-d*60);return b+":"+(d<10?"0"+d:d)+":"+(_<10?"0"+_:_)},unformat:function(a){var l=a.split(":"),m=0;return l.length===3?(m=m+Number(l[0])*60*60,m=m+Number(l[1])*60,m=m+Number(l[2])):l.length===2&&(m=m+Number(l[0])*60,m=m+Number(l[1])),Number(m)}})}(),s})})(vn);var ko=vn.exports;const dn=hn(ko);function Do(h){const s=mn(h)*1e3;let g="m",C="0,0",w,I="ft",F="0,0",P;return w=s,s>=1e3&&(w=s/1e3,g="km",C="0.00"),P=s*3.28084,P>=5280&&(P/=5280,I="mi",F="0.00"),{metric:`${dn(w).format(C)} ${g}`,standard:`${dn(P).format(F)} ${I}`}}function fn(h){const s=h.geometry.coordinates[0],g=mn(h);return wo(s,g)}const Uo={...Lo.modes.draw_line_string,clickAnywhere:function(h,s){return h.currentVertexPosition===1?(h.line.addCoordinate(0,s.lngLat.lng,s.lngLat.lat),this.changeMode("simple_select",{featureIds:[h.line.id]})):(h.line.updateCoordinate(h.currentVertexPosition,s.lngLat.lng,s.lngLat.lat),h.direction==="forward"?(h.currentVertexPosition+=1,h.line.updateCoordinate(h.currentVertexPosition,s.lngLat.lng,s.lngLat.lat)):h.line.addCoordinate(0,s.lngLat.lng,s.lngLat.lat),null)},onStop:function(h){if(this.activateUIButton(),this.getFeature(h.line.id)!==void 0)if(h.line.removeCoordinate("0"),h.line.isValid()){const s=h.line.toGeoJSON(),g=fn(s);this.map.fire("draw.create",{features:[g]})}else this.deleteFeature([h.line.id],{silent:!0}),this.changeMode("simple_select",{},{silent:!0})},toDisplayFeatures:function(h,s,g){if(s.geometry.coordinates.length<2)return null;g({type:"Feature",properties:{active:"true"},geometry:{type:"Point",coordinates:s.geometry.coordinates[0]}}),s.properties.active="true",g(s);const w={type:"Feature",properties:{meta:"currentPosition",radius:`${Do(s).metric}`,parent:h.line.id},geometry:{type:"Point",coordinates:s.geometry.coordinates[1]}};g(w);const I=fn(s);return I.properties={active:"true"},g(I),null}},Bo=[{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}},{id:"gl-draw-symbol",type:"symbol",layout:{"text-line-height":1.1,"text-size":15,"text-font":["DIN Pro Medium","Arial Unicode MS Regular"],"text-anchor":"left","text-justify":"left","text-offset":[.8,.8],"text-field":["get","radius"],"text-max-width":7},paint:{"text-color":"hsl(0, 0%, 95%)","text-halo-color":"hsl(0, 5%, 0%)","text-halo-width":1,"text-halo-blur":1},filter:["==","meta","currentPosition"]}],jo={CircleMode:Uo};let dt,pt,bn;dt=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/light-v11",center:[7.743189929905293,48.09744836188367],zoom:10,accessToken:"pk.eyJ1IjoibWFyY28tc2NpYWluaSIsImEiOiJja3hhdTNqeTAxM2dpMnJxY3hlODdna2FlIn0.ca84aO5lB8kRqzAoNZQvfg"});pt=new MapboxDraw({modes:{...MapboxDraw.modes,draw_circle:jo.CircleMode},displayControlsDefault:!1,controls:{},styles:Bo,userProperties:!0});class Vo{constructor(s){const g=this;g.draw=s.draw,g.buttons=s.buttons||[],g.onAddOrig=s.draw.onAdd,g.onRemoveOrig=s.draw.onRemove}onAdd(s){const g=this;return g.map=s,g.elContainer=g.onAddOrig(s),g.buttons.forEach(C=>{g.addButton(C)}),g.elContainer}onRemove(s){const g=this;g.buttons.forEach(C=>{g.removeButton(C)}),g.onRemoveOrig(s)}addButton(s){const g=this,C=document.createElement("button");C.className="mapbox-gl-draw_ctrl-draw-btn",s.classes instanceof Array&&s.classes.forEach(w=>{C.classList.add(w)}),C.addEventListener(s.on,s.action),C.title=s.title,g.elContainer.appendChild(C),s.elButton=C}removeButton(s){s.elButton.removeEventListener(s.on,s.action),s.elButton.remove()}}window.draw=pt;bn=new Vo({draw:pt,buttons:[{on:"click",action:()=>{console.log("draw_line_string"),pt.changeMode("draw_circle")},classes:["fg-circle-o"],title:"Draw Circular Polygon (c)"}]});dt.once("load",()=>{dt.resize(),dt.addControl(bn,"top-right"),console.log(pt),dt.on("draw.update",function(h){console.log(" ~ file: index.js ~ line 158 ~ e",h)})});
